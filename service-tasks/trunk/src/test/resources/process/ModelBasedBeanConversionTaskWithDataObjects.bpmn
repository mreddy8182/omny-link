<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<!-- 
  definitions/@expressionLanguage specifies a URI denoting ECMAScript 5 (widely supported in browsers and both Rhino and Nashorn)
  definitions/@typeLanguage specifies a URI denoting JSON as standardised by ECMA.
  
  We also need to declare namespaces for Ecmascript, Java and JSON to employ them as QNames within the process. 
-->
<definitions xmlns="http://www.omg.org/spec/BPMN/20100524/MODEL" 
    xmlns:activiti="http://activiti.org/bpmn" 
    xmlns:bpmndi="http://www.omg.org/spec/BPMN/20100524/DI" 
    xmlns:dc="http://www.omg.org/spec/DD/20100524/DC" 
    xmlns:di="http://www.omg.org/spec/DD/20100524/DI" 
    xmlns:ecmascript="http://www.ecma-international.org/ecma-262/5/" 
    xmlns:java="http://java.com/7/" 
    xmlns:json="http://www.ecma-international.org/ecma-404" 
    xmlns:tns="http://knowprocess.com/registration" 
    xmlns:xsd="http://www.w3.org/2001/XMLSchema" 
    xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" 
    xmlns:yaoqiang="http://bpmn.sourceforge.net" 
    exporter="Yaoqiang BPMN Editor" 
    exporterVersion="3.0" 
    expressionLanguage="http://www.ecma-international.org/ecma-262/5/" 
    id="_accountIn87529213597" name="" 
    targetNamespace="http://knowprocess.com/data" 
    typeLanguage="http://www.ecma-international.org/ecma-404" 
    xsi:schemaLocation="http://www.omg.org/spec/BPMN/20100524/MODEL http://bpmn.sourceforge.net/schemas/BPMN20.xsd">
  <message id="kp.newAccount" name="kp.newAccount"/>
  <process id="DataObjectProcess" isClosed="false" isExecutable="true" name="Register new account" processType="Public">
    <documentation id="DataObjectProcess_D_1" textFormat="text/plain"><![CDATA[Receives a message containing a 'new account' data object and pass it through a service task.]]></documentation>
    <extensionElements>
      <yaoqiang:pageFormat height="842.4" imageableHeight="832.4" imageableWidth="587.6" imageableX="5.0" imageableY="5.0" orientation="0" width="597.6"/>
      <yaoqiang:page background="#FFFFFF" horizontalCount="1" verticalCount="1"/>
    </extensionElements>
    <!-- 
      The ioSpecification at the process level defines the data in and out of the process. 
      
      This is already enough to permit start events not containing the specified 
      data to be rejected (with appropriate error) protecting against unexpected 
      errors mid-way through the process where they are harder to handle.  
    -->
    <ioSpecification>
      <!-- 
        dataInput and dataOutput elements give ids, names and cardinality. 
        
        The question of what an itemSubjectRef should mean in a JSON / Java world 
        is interesting. 
          - In JSON we could define an object prototype / literal. 
          - In Java a class name seems appropriate. 
          
        TODO: The question of where these types are defined also arises, do we need an import?
        In the Java case should we use a 'classpath:' notation?  
      -->
      <dataInput id="_accountIn" isCollection="false" name="account" itemSubjectRef="ecmascript:Account"/>
      <dataOutput id="_accountOut" isCollection="false" name="account" itemSubjectRef="java:org.omg.bpmn.miwg.Account"/>
      <inputSet>
        <dataInputRefs>_accountIn</dataInputRefs>
      </inputSet>
      <outputSet>
        <dataOutputRefs>_accountOut</dataOutputRefs>
      </outputSet>
    </ioSpecification>
    <startEvent activiti:initiator="initiator" id="_startEvent" isInterrupting="true" name="Register new account" parallelMultiple="false">
      <outgoing>_14</outgoing>
      <messageEventDefinition id="_startEvent_ED_1" messageRef="kp.newAccount"/>
    </startEvent>
    <endEvent id="_7" name="End Event">
      <incoming>_6</incoming>
    </endEvent>
    <!-- serviceTask/@implementation is defined as a URI that identifies a Java class -->
    <serviceTask completionQuantity="1" id="_registerAccount" implementation="java:org.omg.bpmn.miwg.AccountService" isForCompensation="false" name="Register account" startQuantity="1">
      <incoming>_14</incoming>
      <outgoing>_6</outgoing>
      <ioSpecification>
        <dataInput id="Din_registerAccount_accountIn" isCollection="false"/>
        <dataOutput id="Dout_registerAccount_accountOut" isCollection="false"/>
        <inputSet>
          <dataInputRefs>Din_registerAccount_accountIn</dataInputRefs>
        </inputSet>
        <outputSet>
          <dataOutputRefs>Dout_registerAccount_accountOut</dataOutputRefs>
        </outputSet>
      </ioSpecification>
      <dataInputAssociation id="_3">
        <sourceRef>_accountIn</sourceRef>
        <targetRef>Din_registerAccount_accountIn</targetRef>
      </dataInputAssociation>
      <dataOutputAssociation id="_4">
        <sourceRef>Dout_registerAccount_accountOut</sourceRef>
        <targetRef>_accountOut</targetRef>
      </dataOutputAssociation>
    </serviceTask>
    <sequenceFlow id="_14" sourceRef="_startEvent" targetRef="_registerAccount"/>
    <dataObject id="DO_DataObjectProcess_1" isCollection="false" name="Data Object"/>
    <sequenceFlow id="_6" sourceRef="_registerAccount" targetRef="_7"/>
  </process>
  <bpmndi:BPMNDiagram id="Yaoqiang_Diagram-_1" name="Untitled Diagram" resolution="96.0">
    <bpmndi:BPMNPlane bpmnElement="DataObjectProcess">
      <bpmndi:BPMNShape bpmnElement="_startEvent" id="Yaoqiang-_startEvent">
        <dc:Bounds height="32.0" width="32.0" x="80.0" y="241.5"/>
        <bpmndi:BPMNLabel>
          <dc:Bounds height="18.8046875" width="129.0" x="31.5" y="282.5107421875"/>
        </bpmndi:BPMNLabel>
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape bpmnElement="_7" id="Yaoqiang-_7">
        <dc:Bounds height="32.0" width="32.0" x="700.0" y="241.5"/>
        <bpmndi:BPMNLabel>
          <dc:Bounds height="18.8046875" width="62.0" x="685.0" y="282.5107421875"/>
        </bpmndi:BPMNLabel>
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape bpmnElement="_registerAccount" id="Yaoqiang-_registerAccount">
        <dc:Bounds height="55.0" width="85.0" x="290.0" y="230.0"/>
        <bpmndi:BPMNLabel>
          <dc:Bounds height="18.8046875" width="74.0" x="295.5" y="250.09765625"/>
        </bpmndi:BPMNLabel>
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape bpmnElement="_accountIn" id="Yaoqiang-_accountIn">
        <dc:Bounds height="38.0" width="29.0" x="234.3181818181818" y="147.04545454545456"/>
        <bpmndi:BPMNLabel>
          <dc:Bounds height="18.8046875" width="50.0" x="223.8181818181818" y="187.04545454545456"/>
        </bpmndi:BPMNLabel>
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape bpmnElement="_accountOut" id="Yaoqiang-_accountOut">
        <dc:Bounds height="38.0" width="29.0" x="389.40909090909093" y="148.3181818181818"/>
        <bpmndi:BPMNLabel>
          <dc:Bounds height="18.8046875" width="50.0" x="378.90909090909093" y="188.3181818181818"/>
        </bpmndi:BPMNLabel>
      </bpmndi:BPMNShape>
      <bpmndi:BPMNEdge bpmnElement="_14" id="Yaoqiang-_14">
        <di:waypoint x="111.67768541667117" y="257.5"/>
        <di:waypoint x="289.68181818181824" y="257.5"/>
        <bpmndi:BPMNLabel>
          <dc:Bounds height="18.8046875" width="6.0" x="197.67975179924468" y="248.09765625"/>
        </bpmndi:BPMNLabel>
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge bpmnElement="_6" id="Yaoqiang-_6">
        <di:waypoint x="374.68181818181824" y="257.5"/>
        <di:waypoint x="699.6859509469654" y="257.5"/>
        <bpmndi:BPMNLabel>
          <dc:Bounds height="18.8046875" width="6.0" x="534.1838845643917" y="248.09765625"/>
        </bpmndi:BPMNLabel>
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge bpmnElement="_4" id="Yaoqiang-_4">
        <di:waypoint x="374.68181818181824" y="257.5"/>
        <di:waypoint x="389.68181818181824" y="167.3181818181818"/>
        <bpmndi:BPMNLabel>
          <dc:Bounds height="18.8046875" width="6.0" x="379.2045454545455" y="203.02947443181816"/>
        </bpmndi:BPMNLabel>
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge bpmnElement="_3" id="Yaoqiang-_3">
        <di:waypoint x="263.68181818181824" y="166.04545454545456"/>
        <di:waypoint x="289.68181818181824" y="257.5"/>
        <bpmndi:BPMNLabel>
          <dc:Bounds height="18.8046875" width="6.0" x="273.6590909090909" y="202.39311079545465"/>
        </bpmndi:BPMNLabel>
      </bpmndi:BPMNEdge>
    </bpmndi:BPMNPlane>
  </bpmndi:BPMNDiagram>
</definitions>
